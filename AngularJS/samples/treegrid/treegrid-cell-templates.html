<!DOCTYPE html>
<html dir="ltr" lang="en">
	<head>
	  	<meta charset="utf-8">
	  	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0">
	  	<title>IntegralUI Web - TreeGrid / Cell Templates</title>
		<link rel="stylesheet" href="../../index.css" />
		<style type="text/css">
		</style>
	</head>
	<body ng-app="appModule" ng-controller="appCtrl">
        <h2>TreeGrid / Cell Templates</h2>
		<div class="sample-block">
			<iui-treegrid id="treegrid-cell-templates"
                allow-animation="true"
                ng-prop-columns="columns"
                ng-prop-custom_style="gridStyle"
                ng-prop-row_template="currentRowCellTemplate"
                ng-prop-show_footer="false"
                ng-prop-size="ctrlSize"
                ng-prop-rows="rows"
                resource-path="../../node_modules/integralui-web/icons"
                row-height="30"
				theme="Office"
			> 
			</iui-treegrid>
			<div class="feature-help">
                <p><span class="initial-space"></span>An example of a TreeGrid where some of the cells are using custom template for their content:</p>
                <ul class="feature-points">
                    <li><span class="code-object">Cells with a check box</span> - When check box in column header is clicked, it will update all cells in that column.</li>
                    <li><span class="code-object">Cells with price indicator</span> - represented by up/down icons algned on left side with price on right.</li>
                    <li><span class="code-object">Cells with change indicator</span> - represented by a progress bar on the right side.</li>
                    <li><span class="code-object">Cells with button</span> - when clicked will remove the row.</li>
                </ul>
			</div>
		</div>
	</body>
    <script type="text/javascript" src="../../angular.min.js"></script>
	<script type="module" src="../../node_modules/integralui-web/components/integralui.button.js"></script>
	<script type="module" src="../../node_modules/integralui-web/components/integralui.checkbox.js"></script>
	<script type="module" src="../../node_modules/integralui-web/components/integralui.treegrid.js"></script>
	<script type="module">
        import { html } from '../../node_modules/integralui-web/external/lit-element.js';
        import { classMap } from '../../node_modules/integralui-web/external/class-map.js';
        import { styleMap } from '../../node_modules/integralui-web/external/style-map.js';
        import { IntegralUIEditorType, IntegralUITheme } from '../../node_modules/integralui-web/components/integralui.enums.js';
        import { iuiTreeGridCellTemplatesStyle } from './treegrid-cell-templates.style.js';

        angular
           .module("appModule", [])
           .controller("appCtrl", ["$scope", "$timeout", function($scope, $timeout){

                //
                // TreeGrid settings
                //

                const treegrid = document.querySelector('#treegrid-cell-templates');

                $scope.ctrlSize = { width: 900, height: 450 }
                $scope.gridStyle = iuiTreeGridCellTemplatesStyle;

                //
                // Currently when using templates, the LitElement binding syntax is required
                // for properties, methods and events
                //
                $scope.currentRowCellTemplate = (row, cell) => { 
                    switch (cell.cid){
                        case 2:
                            return html`<div class="price-cell">
                                    <span class=${classMap(getPriceClass(cell))}></span> ${cell.text}
                                </div>`;

                        case 4:
                            return html`<div class="change-cell">
                                    <span>${cell.text}</span>
                                    <p class=${classMap(getProgressClass(cell.indicator))} style=${styleMap({ width: getProgressWidth(cell.progress) + 'px' })}></p>
                                </div>`;

                        case 7:
                            return html`<div class="button-cell">
                                    <iui-button theme="Office" @mousedown="${() => deleteRow(row)}">Delete</iui-button>
                                </div>`;

                        case 9:
                            return html`<div style=${styleMap({ display: 'inline-block' })}>
                                    <span class="treegrid-ctpl-item-label">${cell.text}</span>
                                </div>`;

                        default:
                            return html`<span class="label-cell">${cell.text}</span>`;
                    }
                };

                $scope.columns = [
                    { id: 1, headerText: "Company", width: 190},
                    { id: 9, editorType: IntegralUIEditorType.CheckBox, width: 30, fixedWidth: true },
                    { id: 2, headerText: "Price", headerAlignment: 'center', width: 90, contentAlignment: 'right' },
                    { id: 3, headerText: "Change", width: 80, contentAlignment: 'center' },
                    { id: 4, headerText: "Change %", width: 110, minWidth: 120, headerAlignment: 'center' },
                    { id: 5, headerText: "Volume", width: 110, headerAlignment: 'center', contentAlignment: 'right' },
                    { id: 6, headerText: "Country" },
                    { id: 7, width: 90 }
                ];

                $scope.rows = [
                    { 
                        id: 1,
                        text: "Europe",
                        cells: [{ cid: 1, text: "Europe" }, { cid: 7 }],
                        rows: [
                            { 
                                id: 11,
                                pid: 1,
                                cells: [
                                    { cid: 9, value: true },
                                    { cid: 1, text: "Augue LLC" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$7.43"
                                    },
                                    { cid: 3, text: "+2.83" },
                                    {
                                        cid: 4, 
                                        progress: 18.5,
                                        text: "+18.50%"
                                    },
                                    { cid: 5, text: "12,251,937" },
                                    { cid: 6, text: "Germany" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 12,
                                pid: 1,
                                cells: [
                                    { cid: 9, value: true },
                                    { cid: 1, text: "Porttitor Corp." },
                                    {
                                        cid: 2, 
                                        indicator: false,
                                        text: "$196.53"
                                    },
                                    { cid: 3, text: "-1.47" },
                                    {
                                        cid: 4, 
                                        indicator: false,
                                        progress: 4.2,
                                        text: "-4.21%"
                                    },
                                    { cid: 5, text: "2,763,552" },
                                    { cid: 6, text: "Italy" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 13,
                                pid: 1,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Id Risus PC" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$69.23"
                                    },
                                    { cid: 3, text: "+3.51" },
                                    {
                                        cid: 4, 
                                        progress: 5.59,
                                        text: "+5.59%"
                                    },
                                    { cid: 5, text: "15,973,926" },
                                    { cid: 6, text: "France" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 14,
                                pid: 1,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Magna Sed Limited" },
                                    {
                                        cid: 2, 
                                        text: "$78.60"
                                    },
                                    { cid: 3, text: "+0.07" },
                                    {
                                        cid: 4, 
                                        progress: 0,
                                        text: "+0.00%"
                                    },
                                    { cid: 5, text: "5,198,276" },
                                    { cid: 6, text: "Germany" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 15,
                                pid: 1,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Mi Felis Ltd" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$27.85"
                                    },
                                    { cid: 3, text: "+3.17" },
                                    {
                                        cid: 4, 
                                        progress: 2.67,
                                        text: "+2.67%"
                                    },
                                    { cid: 5, text: "1,945,483" },
                                    { cid: 6, text: "France" },
                                    { cid: 7 }
                                ]
                            }
                        ]
                    },
                    { 
                        id: 2,
                        text: "Asia",
                        cells: [{ cid: 1, text: "Asia" }, { cid: 7 }],
                        rows: [
                            { 
                                id: 21,
                                pid: 2,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Varius Orci In PC" },
                                    {
                                        cid: 2, 
                                        indicator: false,
                                        text: "$59.27"
                                    },
                                    { cid: 3, text: "-3.39" },
                                    {
                                        cid: 4, 
                                        indicator: false,
                                        progress: 6.92,
                                        text: "-6.92%"
                                    },
                                    { cid: 5, text: "7,920,374" },
                                    { cid: 6, text: "India" },
                                    { cid: 7 }
                                ]
                            },
                        ]
                    },
                    { 
                        id: 3,
                        text: "North America",
                        cells: [{ cid: 1, text: "North America" }, { cid: 7 }],
                        rows: [
                            { 
                                id: 31,
                                pid: 3,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Hymenaeos Corporation" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$44.67"
                                    },
                                    { cid: 3, text: "+8.67" },
                                    {
                                        cid: 4, 
                                        progress: 12.68,
                                        text: "+12.68%"
                                    },
                                    { cid: 5, text: "3,399,847" },
                                    { cid: 6, text: "Canada" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 32,
                                pid: 3,
                                cells: [
                                    { cid: 9, value: true },
                                    { cid: 1, text: "Urna Institute" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$77.79"
                                    },
                                    { cid: 3, text: "+0.79" },
                                    {
                                        cid: 4, 
                                        progress: 3.24,
                                        text: "+3.24%"
                                    },
                                    { cid: 5, text: "9,732,775" },
                                    { cid: 6, text: "USA" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 33,
                                pid: 3,
                                cells: [
                                    { cid: 9, value: true },
                                    { cid: 1, text: "Proin Ltd" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$290.32"
                                    },
                                    { cid: 3, text: "+1.28" },
                                    {
                                        cid: 4, 
                                        progress: 4.92,
                                        text: "+4.92%"
                                    },
                                    { cid: 5, text: "5,999,324" },
                                    { cid: 6, text: "USA" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 34,
                                pid: 3,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Id Consulting" },
                                    {
                                        cid: 2, 
                                        indicator: false,
                                        text: "$54.99"
                                    },
                                    { cid: 3, text: "-2.39" },
                                    {
                                        cid: 4, 
                                        indicator: false,
                                        progress: 6.12,
                                        text: "-6.12%"
                                    },
                                    { cid: 5, text: "3,542,897" },
                                    { cid: 6, text: "Mexico" },
                                    { cid: 7 }
                                ]
                            },
                        ]
                    },
                    { 
                        id: 4,
                        text: "South America",
                        cells: [{ cid: 1, text: "South America" }, { cid: 7 }],
                        rows: [
                            { 
                                id: 41,
                                pid: 4,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Lacus Aliquam Consulting" },
                                    {
                                        cid: 2, 
                                        indicator: true,
                                        text: "$32.46"
                                    },
                                    { cid: 3, text: "+5.23" },
                                    {
                                        cid: 4, 
                                        progress: 7.15,
                                        text: "+7.15%"
                                    },
                                    { cid: 5, text: "2,749,325" },
                                    { cid: 6, text: "Brazil" },
                                    { cid: 7 }
                                ]
                            },
                            { 
                                id: 42,
                                pid: 4,
                                cells: [
                                    { cid: 9 },
                                    { cid: 1, text: "Viverra LLC" },
                                    {
                                        cid: 2, 
                                        indicator: false,
                                        text: "$9.76"
                                    },
                                    { cid: 3, text: "-9.25" },
                                    {
                                        cid: 4, 
                                        indicator: false,
                                        progress: 24.31,
                                        text: "-24.31%"
                                    },
                                    { cid: 5, text: "6,892,784" },
                                    { cid: 6, text: "Argentina" },
                                    { cid: 7 }
                                ]
                            },
                        ]
                    }
                ];


                // Price Cell ------------------------------------------------------------------------

                let getPriceClass = function(cell){
                    let classList = { 'icons': true }

                    if (cell.indicator)
                        classList['price-up'] = true;
                    else
                        classList['price-down'] = true;

                    return classList;
                }

                // Progress Cell ---------------------------------------------------------------------

                let getProgressClass = function(indicator){
                    return indicator !== false ? { ['progress-blue']: true } : { ['progress-red']: true };
                }

                let getProgressWidth = function(value){
                    return Math.floor(value * 5 / 3);
                }

                // Button Cell -----------------------------------------------------------------------

                let deleteRow = function(row){
                    if (row){
                        treegrid.removeRow(row);
                        treegrid.updateLayout();
                    }
                }

        }]);
	</script>
</html>
